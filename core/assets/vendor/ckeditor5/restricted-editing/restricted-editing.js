!function(e){const t=e.en=e.en||{};t.dictionary=Object.assign(t.dictionary||{},{"Disable block editing":"Disable block editing","Disable editing":"Disable editing","Disable inline editing":"Disable inline editing","Enable block editing":"Enable block editing","Enable editing":"Enable editing","Enable inline editing":"Enable inline editing","Navigate editable regions":"Navigate editable regions","Next editable region":"Next editable region","Previous editable region":"Previous editable region"})}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),
/*!
 * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(()=>{var e={163:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},237:e=>{"use strict";e.exports=CKEditor5.dll},305:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i="",n=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),n&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),n&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i}).join("")},t.i=function(e,i,n,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var c=0;c<this.length;c++){var d=this[c][0];null!=d&&(s[d]=!0)}for(var a=0;a<e.length;a++){var l=[].concat(e[a]);n&&s[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),i&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=i):l[2]=i),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),t.push(l))}},t}},311:(e,t,i)=>{e.exports=i(237)("./src/ui.js")},355:(e,t,i)=>{e.exports=i(237)("./src/icons.js")},424:e=>{"use strict";var t={};e.exports=function(e,i){var n=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},517:e=>{"use strict";e.exports=function(e,t){Object.keys(t).forEach(function(i){e.setAttribute(i,t[i])})}},584:(e,t,i)=>{e.exports=i(237)("./src/utils.js")},719:e=>{"use strict";var t=[];function i(e){for(var i=-1,n=0;n<t.length;n++)if(t[n].identifier===e){i=n;break}return i}function n(e,n){for(var o={},s=[],c=0;c<e.length;c++){var d=e[c],a=n.base?d[0]+n.base:d[0],l=o[a]||0,u="".concat(a," ").concat(l);o[a]=l+1;var g=i(u),m={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==g)t[g].references++,t[g].updater(m);else{var p=r(m,n);n.byIndex=c,t.splice(c,0,{identifier:u,updater:p,references:1})}s.push(u)}return s}function r(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,r){var o=n(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var c=i(o[s]);t[c].references--}for(var d=n(e,r),a=0;a<o.length;a++){var l=i(o[a]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}o=d}}},782:(e,t,i)=>{e.exports=i(237)("./src/core.js")},783:(e,t,i)=>{e.exports=i(237)("./src/engine.js")},792:e=>{"use strict";e.exports=function(e){return e[1]}},798:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var n=i(792),r=i.n(n),o=i(305),s=i.n(o)()(r());s.push([e.id,":root{--ck-color-restricted-editing-exception-background:rgba(255,169,77,.2);--ck-color-restricted-editing-exception-hover-background:rgba(255,169,77,.35);--ck-color-restricted-editing-exception-brackets:rgba(204,105,0,.4);--ck-color-restricted-editing-selected-exception-background:rgba(255,169,77,.5);--ck-color-restricted-editing-selected-exception-brackets:rgba(204,105,0,.6)}.ck-editor__editable .restricted-editing-exception{background-color:var(--ck-color-restricted-editing-exception-background);border:1px solid;border-image:linear-gradient(to right,var(--ck-color-restricted-editing-exception-brackets) 0,var(--ck-color-restricted-editing-exception-brackets) 5px,transparent 6px,transparent calc(100% - 6px),var(--ck-color-restricted-editing-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-exception-brackets) 100%) 1;transition:background .2s ease-in-out}@media (prefers-reduced-motion:reduce){.ck-editor__editable .restricted-editing-exception{transition:none}}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_selected{background-color:var(--ck-color-restricted-editing-selected-exception-background);border-image:linear-gradient(to right,var(--ck-color-restricted-editing-selected-exception-brackets) 0,var(--ck-color-restricted-editing-selected-exception-brackets) 5px,var(--ck-color-restricted-editing-selected-exception-brackets) calc(100% - 5px),var(--ck-color-restricted-editing-selected-exception-brackets) 100%) 1}.ck-editor__editable .restricted-editing-exception.restricted-editing-exception_collapsed{padding-left:1ch}.ck-restricted-editing_mode_restricted,.ck-restricted-editing_mode_restricted *{cursor:default}.ck-restricted-editing_mode_restricted .restricted-editing-exception,.ck-restricted-editing_mode_restricted .restricted-editing-exception *{cursor:text}.ck-restricted-editing_mode_restricted .restricted-editing-exception:hover{background:var(--ck-color-restricted-editing-exception-hover-background)}",""]);const c=s},863:e=>{"use strict";var t,i=(t=[],function(e,i){return t[e]=i,t.filter(Boolean).join("\n")});function n(e,t,n,r){var o;if(n)o="";else{o="",r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var s=void 0!==r.layer;s&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,s&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}")}if(e.styleSheet)e.styleSheet.cssText=i(t,o);else{var c=document.createTextNode(o),d=e.childNodes;d[t]&&e.removeChild(d[t]),d.length?e.insertBefore(c,d[t]):e.appendChild(c)}}var r={singleton:null,singletonCounter:0};e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=r.singletonCounter++,i=r.singleton||(r.singleton=e.insertStyleElement(e));return{update:function(e){n(i,t,!1,e)},remove:function(e){n(i,t,!0,e)}}}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={id:n,exports:{}};return e[n](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";i.r(n),i.d(n,{RestrictedEditingExceptionAutoCommand:()=>q,RestrictedEditingExceptionBlockCommand:()=>L,RestrictedEditingExceptionCommand:()=>V,RestrictedEditingMode:()=>F,RestrictedEditingModeEditing:()=>b,RestrictedEditingModeNavigationCommand:()=>d,RestrictedEditingModeUI:()=>C,StandardEditingMode:()=>H,StandardEditingModeEditing:()=>K,StandardEditingModeUI:()=>U,_extendRestrictedEditingMarkerOnTypingPostFixer:()=>p,_getRestrictedEditingMarkerAtPosition:()=>r,_isRestrictedEditingPositionInRangeBoundaries:()=>o,_isRestrictedEditingSelectionInMarker:()=>s,_resurrectRestrictedEditingCollapsedMarkerPostFixer:()=>m,_setupRestrictedEditingExceptionHighlighting:()=>g,_upcastRestrictedEditingHighlightToMarker:()=>E});var e=i(782),t=i(584);function r(e,t){for(const i of e.model.markers){if(o(c(i,e.model),t)&&i.name.startsWith("restrictedEditingException:"))return i}}function o(e,t){return e.containsPosition(t)||e.end.isEqual(t)||e.start.isEqual(t)}function s(e,t,i){if(!i)return!1;const n=c(i,t);return e.isCollapsed?o(n,e.focus):n.containsRange(e.getFirstRange(),!0)}function c(e,t){const i=e.getRange(),n=i.getContainedElement();return n&&n.is("element","restrictedEditingException")?t.createRangeIn(n):i}class d extends e.Command{_direction;constructor(e,t){super(e),this.affectsData=!1,this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=a(this.editor.model,this._direction);e&&this.editor.model.change(t=>{t.setSelection(e)})}_checkEnabled(){return!!a(this.editor.model,this._direction)}}function a(e,t){const i=e.document.selection.getFirstPosition(),n=[];for(const r of e.markers.getMarkersGroup("restrictedEditingException")){const o=c(r,e),s=i.isTouching(o.start)&&i.hasSameParentAs(o.start)||i.isTouching(o.end)&&i.hasSameParentAs(o.end);o.containsPosition(i)||s||("forward"===t&&o.start.isAfter(i)||"backward"===t&&o.end.isBefore(i))&&n.push(o)}if(n.length)return n.sort((e,i)=>"forward"===t?e.start.isAfter(i.start)?1:-1:e.start.isBefore(i.start)?1:-1).shift()}var l=i(783);const u="restricted-editing-exception_selected";function g(e){const t=e.editing.view,i=e.model,n=new Set;t.document.registerPostFixer(t=>{const o=i.document.selection,s=r(e,o.anchor);if(!s)return!1;const c=s.getRange().getContainedElement();if(c&&c.is("element","restrictedEditingException")){const i=e.editing.mapper.toViewElement(c);t.addClass(u,i),n.add(i)}else for(const i of e.editing.mapper.markerNameToElements(s.name))t.addClass(u,i),n.add(i);return!1}),e.conversion.for("editingDowncast").add(e=>{function i(){t.change(e=>{for(const t of n.values())e.removeClass(u,t),n.delete(t)})}e.on("insert",i,{priority:"highest"}),e.on("remove",i,{priority:"highest"}),e.on("attribute",i,{priority:"highest"}),e.on("cleanSelection",i)})}function m(e){return t=>{let i=!1;for(const{name:n,data:r}of e.model.document.differ.getChangedMarkers())n.startsWith("restrictedEditingException")&&r.newRange&&"$graveyard"==r.newRange.root.rootName&&(t.updateMarker(n,{range:t.createRange(t.createPositionAt(r.oldRange.start))}),i=!0);return i}}function p(e){return t=>{let i=!1;const n=e.model.schema;for(const r of e.model.document.differ.getChanges())"insert"==r.type&&n.checkChild("$block",r.name)&&(i=f(e,r.position,r.length,t)||i,i=h(e,r.position,r.length,t)||i);return i}}function E(e){return t=>t.on("element",(t,i,n)=>{const{writer:r}=n,o=new l.Matcher(e.view).match(i.viewItem);if(!o)return;const s=o.match;if(s.name=!0,!n.consumable.test(i.viewItem,s))return;let c=i.modelCursor,d=null;if(e.useWrapperElement){if(!n.schema.checkChild(c,"restrictedEditingException"))return;d=r.createElement("restrictedEditingException"),r.insert(d,c),c=r.createPositionAt(d,0)}const{modelRange:a}=n.convertChildren(i.viewItem,c);n.consumable.consume(i.viewItem,s);const u=e.model(),g=r.createElement("$marker",{"data-name":u}),m=r.createElement("$marker",{"data-name":u});d?(r.insert(g,r.createPositionBefore(d)),r.insert(m,r.createPositionAfter(d))):(r.insert(m,a.end),r.insert(g,a.start)),i.modelRange=r.createRange(r.createPositionBefore(g),r.createPositionAfter(m)),i.modelCursor=i.modelRange.end})}function f(e,t,i,n){const o=r(e,t.getShiftedBy(i));return!(!o||!o.getStart().isEqual(t.getShiftedBy(i)))&&(n.updateMarker(o,{range:n.createRange(o.getStart().getShiftedBy(-i),o.getEnd())}),!0)}function h(e,t,i,n){const o=r(e,t);return!(!o||!o.getEnd().isEqual(t))&&(n.updateMarker(o,{range:n.createRange(o.getStart(),o.getEnd().getShiftedBy(i))}),!0)}const x="RestrictedEditingMode";class b extends e.Plugin{_alwaysEnabled;_allowedInException;static get pluginName(){return"RestrictedEditingModeEditing"}static get licenseFeatureCode(){return"RED"}static get isOfficialPlugin(){return!0}static get isPremiumPlugin(){return!0}constructor(e){super(e),e.config.define("restrictedEditing",{allowedCommands:["bold","italic","link","unlink"],allowedAttributes:["bold","italic","linkHref"]}),this._alwaysEnabled=new Set(["undo","redo"]),this._allowedInException=new Set(["input","insertText","delete","deleteForward"])}init(){const e=this.editor,i=e.editing.view;e.config.get("restrictedEditing.allowedCommands").forEach(e=>this._allowedInException.add(e)),this._setupSchema(),this._setupConversion(),this._setupCommandsToggling(),this._setupRestrictions(),e.commands.add("goToPreviousRestrictedEditingException",new d(e,"backward")),e.commands.add("goToNextRestrictedEditingException",new d(e,"forward")),this.listenTo(i.document,"tab",(t,i)=>{const n=i.shiftKey?"goToPreviousRestrictedEditingException":"goToNextRestrictedEditingException";e.commands.get(n).isEnabled&&(e.execute(n),i.preventDefault(),i.stopPropagation()),t.stop()},{context:"$capture"}),this.listenTo(i.document,"keydown",function(e){return(i,n)=>{if((0,t.getCode)(n)!=(0,t.parseKeystroke)("Ctrl+A"))return;const o=e.model,s=e.model.document.selection,d=r(e,s.focus);if(!d)return;const a=s.getFirstRange(),l=c(d,e.model);(l.containsRange(a,!0)||s.isCollapsed)&&(i.stop(),n.preventDefault(),n.stopPropagation(),o.change(e=>{e.setSelection(l)}))}}(e),{priority:"high"}),i.change(e=>{for(const t of i.document.roots)e.addClass("ck-restricted-editing_mode_restricted",t)}),e.data.on("set",()=>{e.model.change(t=>{for(const i of e.model.markers.getMarkersGroup("restrictedEditingException"))t.removeMarker(i.name)})},{priority:"high"})}enableCommand(e){this.editor.commands.get(e).clearForceDisabled(x),this._alwaysEnabled.add(e)}_setupSchema(){this.editor.model.schema.register("restrictedEditingException",{allowWhere:"$block",allowContentOf:"$container",isLimit:!0})}_setupConversion(){const e=this.editor,t=e.model.document;let i=0;e.conversion.for("upcast").add(E({view:{name:"span",classes:"restricted-editing-exception"},model:()=>(i++,`restrictedEditingException:inline:${i}`)})),e.conversion.for("upcast").add(E({view:{name:"div",classes:"restricted-editing-exception"},model:()=>(i++,`restrictedEditingException:block:${i}`),useWrapperElement:!0})),e.conversion.for("downcast").elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),e.conversion.for("downcast").add(e=>{e.on("addMarker:restrictedEditingException:inline",(e,t,i)=>{if(!t.item)return;if(t.item.is("selection")||!i.schema.isInline(t.item))return;if(!i.consumable.consume(t.item,e.name))return;const n=i.writer,r=n.createAttributeElement("span",{class:"restricted-editing-exception"},{id:t.markerName,priority:-10}),o=i.mapper.toViewRange(t.range),s=n.wrap(o,r);for(const e of s.getItems())if(e.is("attributeElement")&&e.isSimilar(r)){i.mapper.bindElementToMarker(e,t.markerName);break}})}),e.conversion.for("downcast").markerToHighlight({model:"restrictedEditingException:inline",view:()=>({name:"span",classes:"restricted-editing-exception",priority:-10})}),e.conversion.for("editingDowncast").markerToElement({model:"restrictedEditingException:inline",view:(e,{writer:t})=>t.createUIElement("span",{class:"restricted-editing-exception restricted-editing-exception_collapsed"})}),e.conversion.for("dataDowncast").markerToElement({model:"restrictedEditingException:inline",view:(e,{writer:t})=>t.createEmptyElement("span",{class:"restricted-editing-exception"})}),t.registerPostFixer(p(e)),t.registerPostFixer(m(e)),t.registerPostFixer(function(e){return t=>{let i=!1;const n=e.model.document.differ.getChangedMarkers();for(const{data:e,name:r}of n){if(!r.startsWith("restrictedEditingException"))continue;const n=e.newRange;if(!e.oldRange&&!n.isFlat){const e=n.start,o=n.end,s=e.path.length>o.path.length,c=s?n.start:t.createPositionAt(o.parent,0),d=s?t.createPositionAt(e.parent,"end"):n.end;t.updateMarker(r,{range:t.createRange(c,d)}),i=!0}}return i}}(e)),g(e)}_setupRestrictions(){const e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view.document,o=e.plugins.get("ClipboardPipeline");this.listenTo(t,"deleteContent",function(e){return(t,i)=>{const[n]=i,o=r(e,n.focus)||r(e,n.anchor);if(!o)return void t.stop();if(n.isCollapsed)return;const s=c(o,e.model).getIntersection(n.getFirstRange());n.is("documentSelection")?e.model.change(e=>{e.setSelection(s)}):n.setTo(s)}}(e),{priority:"high"});const s=e.commands.get("insertText");s&&this.listenTo(s,"execute",function(e){return(t,i)=>{const[n]=i,{range:r}=n;r&&(k(e,r)||t.stop())}}(e),{priority:"high"}),this.listenTo(o,"contentInsertion",(n,o)=>{k(e,i.getFirstRange())||n.stop();const s=r(e,i.focus);if(s&&s.name.startsWith("restrictedEditingException:inline:")){const i=e.config.get("restrictedEditing.allowedAttributes");t.change(e=>{const t=e.createDocumentFragment(),n=Array.from(e.createRangeIn(o.content).getItems()).filter(e=>e.is("$textProxy"));for(const r of n){for(const t of r.getAttributeKeys())i.includes(t)||e.removeAttribute(t,r);e.append(r,t)}o.content=t})}}),this.listenTo(n,"clipboardOutput",(t,n)=>{"cut"!=n.method||k(e,i.getFirstRange())||t.stop()},{priority:"high"}),t.schema.addChildCheck(e=>{if(e.startsWith("$clipboardHolder"))return!1},"restrictedEditingException")}_setupCommandsToggling(){const e=this.editor.model.document;this._disableCommands(),this.listenTo(e.selection,"change",this._checkCommands.bind(this)),this.listenTo(e,"change:data",this._checkCommands.bind(this))}_checkCommands(){const e=this.editor,t=e.model.document.selection;if(t.rangeCount>1)return void this._disableCommands();const i=r(e,t.focus);this._disableCommands(),s(t,e.model,i)&&this._enableCommands(i)}_enableCommands(e){const t=this.editor,i=t.model.document.selection;for(const[n,r]of t.commands)r.affectsData&&!this._alwaysEnabled.has(n)&&(e.name.startsWith("restrictedEditingException:block:")||this._allowedInException.has(n))&&(v(n,i,c(e,t.model))||r.clearForceDisabled(x))}_disableCommands(){const e=this.editor;for(const[t,i]of e.commands)i.affectsData&&!this._alwaysEnabled.has(t)&&i.forceDisabled(x)}}function v(e,t,i){return!("delete"!=e||!t.isCollapsed||!i.start.isTouching(t.focus))||!("deleteForward"!=e||!t.isCollapsed||!i.end.isTouching(t.focus))}function k(e,t){const i=r(e,t.start),n=r(e,t.end);return i&&n&&n===i}var w=i(355),_=i(311);class C extends e.Plugin{static get pluginName(){return"RestrictedEditingModeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,i=e.t;e.ui.componentFactory.add("restrictedEditing",n=>{const r=(0,_.createDropdown)(n),o=new t.Collection;return this._getButtonDefinitions().forEach(({commandName:e,label:t,keystroke:i})=>{o.add(this._getButtonDefinition(e,t,i))}),(0,_.addListToDropdown)(r,o,{role:"menu"}),r.buttonView.set({label:i("Navigate editable regions"),icon:w.IconContentLock,tooltip:!0,isEnabled:!0,isOn:!1}),this.listenTo(r,"execute",t=>{const{_commandName:i}=t.source;e.execute(i),e.editing.view.focus()}),r}),e.ui.componentFactory.add("menuBar:restrictedEditing",e=>{const t=new _.MenuBarMenuView(e),n=new _.MenuBarMenuListView(e);return n.set({ariaLabel:i("Navigate editable regions"),role:"menu"}),t.buttonView.set({label:i("Navigate editable regions"),icon:w.IconContentLock}),t.panelView.children.add(n),this._getButtonDefinitions().forEach(({commandName:i,label:r,keystroke:o})=>{const s=new _.MenuBarMenuListItemView(e,t),c=this._createMenuBarButton(r,i,o);c.delegate("execute").to(t),s.children.add(c),n.items.add(s)}),t})}_createMenuBarButton(e,t,i){const n=this.editor,r=n.commands.get(t),o=new _.MenuBarMenuListItemButtonView(n.locale);return o.set({label:e,keystroke:i,isEnabled:!0,isOn:!1}),o.bind("isEnabled").to(r),this.listenTo(o,"execute",()=>{n.execute(t),n.editing.view.focus()}),o}_getButtonDefinition(e,t,i){const n=this.editor.commands.get(e),r={type:"button",model:new _.UIModel({label:t,withText:!0,keystroke:i,withKeystroke:!0,role:"menuitem",_commandName:e})};return r.model.bind("isEnabled").to(n,"isEnabled"),r}_getButtonDefinitions(){const e=this.editor.locale.t;return[{commandName:"goToPreviousRestrictedEditingException",label:e("Previous editable region"),keystroke:"Shift+Tab"},{commandName:"goToNextRestrictedEditingException",label:e("Next editable region"),keystroke:"Tab"}]}}var y=i(719),B=i.n(y),S=i(863),R=i.n(S),A=i(424),P=i.n(A),T=i(517),M=i.n(T),I=i(163),D=i.n(I),N=i(798),O={attributes:{"data-cke":!0}};O.setAttributes=M(),O.insert=P().bind(null,"head"),O.domAPI=R(),O.insertStyleElement=D();B()(N.A,O);N.A&&N.A.locals&&N.A.locals;class F extends e.Plugin{static get pluginName(){return"RestrictedEditingMode"}static get isOfficialPlugin(){return!0}static get requires(){return[b,C]}}class V extends e.Command{refresh(){const e=this.editor.model,t=e.document;this.value=!!t.selection.getAttribute("restrictedEditingException"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"restrictedEditingException")}execute(e={}){const t=this.editor.model,i=t.document.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change(e=>{const r=t.schema.getValidRanges(i.getRanges(),"restrictedEditingException");if(i.isCollapsed)if(n)e.setSelectionAttribute("restrictedEditingException",n);else{const t=e=>e.item.getAttribute("restrictedEditingException")===this.value,n=i.focus,r=n.getLastMatchingPosition(t,{direction:"backward"}),o=n.getLastMatchingPosition(t);e.removeSelectionAttribute("restrictedEditingException"),n.isEqual(r)||n.isEqual(o)||e.removeAttribute("restrictedEditingException",e.createRange(r,o))}else for(const t of r)n?e.setAttribute("restrictedEditingException",n,t):e.removeAttribute("restrictedEditingException",t)})}}class L extends e.Command{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,i=t.schema,n=t.document.selection,r=Array.from(n.getSelectedBlocks()),o=void 0===e.forceValue?!this.value:e.forceValue;t.change(e=>{if(o){const t=r.filter(e=>$(e)||W(i,e));this._applyException(e,t)}else{const t=r.map(e=>function(e){let t=e;for(;t.parent;){if("restrictedEditingException"==t.parent.name)return t;t=t.parent}return null}(e)).filter(e=>!!e);this._removeException(e,t)}})}_getValue(){const e=this.editor.model.document.selection,i=(0,t.first)(e.getSelectedBlocks());return!(!i||!$(i))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,i=this.editor.model.schema,n=(0,t.first)(e.getSelectedBlocks());return!!n&&W(i,n)}_removeException(e,t){j(e,t).reverse().forEach(t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const i=e.createPositionBefore(t.start.parent);return void e.move(t,i)}t.end.isAtEnd||e.split(t.end);const i=e.createPositionAfter(t.end.parent);e.move(t,i)})}_applyException(e,t){const i=this.editor.model.schema,n=[];if(j(e,t).reverse().forEach(t=>{let i=$(t.start);i||(i=e.createElement("restrictedEditingException"),e.wrap(t,i)),n.push(i)}),n.reverse(),n.length){const e=n.at(0).previousSibling,t=n.at(-1).nextSibling;e?.is("element","restrictedEditingException")&&n.unshift(e),t?.is("element","restrictedEditingException")&&n.push(t)}n.reduce((t,i)=>t.nextSibling==i?(e.merge(e.createPositionAfter(t)),t):i),i.removeDisallowedAttributes(t,e)}}function $(e){return e.findAncestor("restrictedEditingException",{includeSelf:!0})}function j(e,t){let i,n=0;const r=[];for(;n<t.length;){const o=t[n],s=t[n+1];i||(i=e.createPositionBefore(o)),s&&o.nextSibling==s||(r.push(e.createRange(i,e.createPositionAfter(o))),i=null),n++}return r}function W(e,t){const i=e.createContext(t.parent);return!!e.checkChild(i,"restrictedEditingException")&&!!e.checkChild(i.push("restrictedEditingException"),t)}class q extends e.Command{_inlineCommand;_blockCommand;constructor(e){super(e),this._inlineCommand=e.commands.get("restrictedEditingException"),this._blockCommand=e.commands.get("restrictedEditingExceptionBlock")}refresh(){this.value=this._inlineCommand.value||this._blockCommand.value,this.isEnabled=this._inlineCommand.isEnabled||this._blockCommand.isEnabled}execute(){const e=this.editor;if(this._inlineCommand.value)e.execute("restrictedEditingException");else if(this._blockCommand.value)e.execute("restrictedEditingExceptionBlock");else if(this._inlineCommand.isEnabled&&!this._blockCommand.isEnabled)e.execute("restrictedEditingException");else if(this._blockCommand.isEnabled&&!this._inlineCommand.isEnabled)e.execute("restrictedEditingExceptionBlock");else{const i=e.model.schema,n=e.model.document.selection,r=n.getSelectedElement();n.isCollapsed||r&&i.isObject(r)&&i.isBlock(r)||(0,t.count)(n.getSelectedBlocks())>1?e.execute("restrictedEditingExceptionBlock"):e.execute("restrictedEditingException")}}}class K extends e.Plugin{static get pluginName(){return"StandardEditingModeEditing"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.model.schema;t.extend("$text",{allowAttributes:["restrictedEditingException"]}),t.register("restrictedEditingException",{allowWhere:"$container",allowContentOf:"$container"}),t.addChildCheck(e=>{for(const t of e)if("restrictedEditingException"==t.name)return!1},"restrictedEditingException"),t.addAttributeCheck(e=>{for(const t of e)if("restrictedEditingException"==t.name)return!1},"restrictedEditingException"),e.model.document.registerPostFixer(i=>{const n=e.model.document.differ.getChanges(),r=new Set,o=new Set,s=new Set;let c=!1;for(const e of n)if("insert"==e.type){const n=i.createRange(e.position,e.position.getShiftedBy(e.length));for(const e of n.getItems())e.is("element","restrictedEditingException")?t.checkChild(i.createPositionBefore(e),e)?e.isEmpty?o.add(e):s.add(e):r.add(e):e.is("$textProxy")&&e.hasAttribute("restrictedEditingException")&&!t.checkAttribute(e,"restrictedEditingException")&&(i.removeAttribute("restrictedEditingException",e),c=!0)}else if("remove"==e.type){const t=e.position.parent;t.is("element","restrictedEditingException")&&t.isEmpty&&o.add(t);for(const e of t.getChildren())e.is("element","restrictedEditingException")&&s.add(e)}for(const e of r)i.unwrap(e),c=!0;for(const e of o)i.remove(e),c=!0;for(const e of s){if("$graveyard"==e.root.rootName)continue;const t=e.previousSibling,n=e.nextSibling;t&&t.is("element","restrictedEditingException")&&i.merge(i.createPositionBefore(e)),n&&n.is("element","restrictedEditingException")&&i.merge(i.createPositionAfter(e))}return c}),e.conversion.for("upcast").elementToAttribute({model:"restrictedEditingException",view:{name:"span",classes:"restricted-editing-exception"}}).elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),function(e){const t=new l.Matcher({name:"span",classes:"restricted-editing-exception"});e.conversion.for("upcast").add(e=>e.on("element:span",(e,i,n)=>{const r=t.match(i.viewItem);if(!r)return;const o=r.match;if(!n.consumable.test(i.viewItem,o))return;const s=n.writer.createText(" ",{restrictedEditingException:!0});n.safeInsert(s,i.modelCursor)&&(n.consumable.consume(i.viewItem,o),i.modelRange=n.writer.createRange(i.modelCursor,i.modelCursor.getShiftedBy(s.offsetSize)),i.modelCursor=i.modelRange.end)},{priority:"low"}))}(e),e.conversion.for("downcast").attributeToElement({model:"restrictedEditingException",view:(e,{writer:t})=>{if(e)return t.createAttributeElement("span",{class:"restricted-editing-exception"},{priority:-10})}}).elementToElement({model:"restrictedEditingException",view:{name:"div",classes:"restricted-editing-exception"}}),e.commands.add("restrictedEditingException",new V(e)),e.commands.add("restrictedEditingExceptionBlock",new L(e)),e.commands.add("restrictedEditingExceptionAuto",new q(e)),e.editing.view.change(t=>{for(const i of e.editing.view.document.roots)t.addClass("ck-restricted-editing_mode_standard",i)})}}class U extends e.Plugin{static get pluginName(){return"StandardEditingModeUI"}static get isOfficialPlugin(){return!0}init(){const e=this.editor,t=e.ui.componentFactory;t.add("restrictedEditingException:dropdown",i=>{const n=(0,_.createDropdown)(i),r=i.t,o=[t.create("restrictedEditingException:inline"),t.create("restrictedEditingException:block")];for(const e of o)e.set({withText:!0,tooltip:!1});return(0,_.addToolbarToDropdown)(n,o,{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:r("Enable editing")}),n.buttonView.set({label:r("Enable editing"),icon:w.IconContentUnlock,tooltip:!0}),n.extendTemplate({attributes:{class:"ck-restricted-editing-dropdown"}}),n.bind("isEnabled").toMany(o,"isEnabled",(...e)=>e.some(e=>e)),this.listenTo(n,"execute",()=>{e.editing.view.focus()}),n}),t.add("restrictedEditingException:inline",()=>{const e=this._createButton("restrictedEditingException",_.ButtonView);return e.set({tooltip:!0}),e}),t.add("restrictedEditingException:block",()=>{const e=this._createButton("restrictedEditingExceptionBlock",_.ButtonView);return e.set({tooltip:!0}),e}),t.add("menuBar:restrictedEditingException:inline",()=>this._createButton("restrictedEditingException",_.MenuBarMenuListItemButtonView)),t.add("menuBar:restrictedEditingException:block",()=>this._createButton("restrictedEditingExceptionBlock",_.MenuBarMenuListItemButtonView)),t.add("restrictedEditingException:auto",()=>{const e=this._createButton("restrictedEditingExceptionAuto",_.ButtonView);return e.set({tooltip:!0}),e}),t.add("menuBar:restrictedEditingException:auto",()=>this._createButton("restrictedEditingExceptionAuto",_.MenuBarMenuListItemButtonView)),t.add("restrictedEditingException",()=>t.create("restrictedEditingException:inline")),t.add("menuBar:restrictedEditingException",()=>t.create("menuBar:restrictedEditingException:inline"))}_createButton(e,t){const i=this.editor,n=i.locale,r=this.editor.commands.get(e),o=new t(n),s=n.t;return o.icon=w.IconContentUnlock,o.isToggleable=!0,o.bind("isOn","isEnabled").to(r,"value","isEnabled"),"restrictedEditingExceptionAuto"==e?o.bind("label").to(r,"value",e=>s(e?"Disable editing":"Enable editing")):"restrictedEditingExceptionBlock"==e?o.bind("label").to(r,"value",e=>s(e?"Disable block editing":"Enable block editing")):o.bind("label").to(r,"value",e=>s(e?"Disable inline editing":"Enable inline editing")),this.listenTo(o,"execute",()=>{i.execute(e),i.editing.view.focus()}),o}}class H extends e.Plugin{static get pluginName(){return"StandardEditingMode"}static get isOfficialPlugin(){return!0}static get requires(){return[K,U]}}})(),(window.CKEditor5=window.CKEditor5||{}).restrictedEditing=n})();